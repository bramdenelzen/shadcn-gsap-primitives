{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "text-reveal",
  "type": "registry:ui",
  "dependencies": [
    "@radix-ui/react-slot",
    "class-variance-authority",
    "gsap",
    "@gsap/react"
  ],
  "files": [
    {
      "path": "registry/new-york/gsap-primitives/text-animations/text-reveal.tsx",
      "content": "\"use client\";\n\nimport * as React from \"react\";\nimport { Slot } from \"@radix-ui/react-slot\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\nimport { useGSAP } from \"@gsap/react\";\nimport gsap from \"gsap\";\nimport { ScrollTrigger } from \"gsap/ScrollTrigger\";\nimport { cn } from \"@/lib/utils\";\n\ngsap.registerPlugin(ScrollTrigger);\n\nconst textRevealVariants = cva(\"inline-block\", {\n  variants: {\n    variant: {\n      fade: \"\",\n      slideUp: \"\",\n      slideDown: \"\",\n      slideLeft: \"\",\n      slideRight: \"\",\n      scale: \"\",\n      blur: \"\",\n    },\n    duration: {\n      fast: \"\",\n      normal: \"\",\n      slow: \"\",\n    },\n    stagger: {\n      none: \"\",\n      small: \"\",\n      medium: \"\",\n      large: \"\",\n    },\n  },\n  defaultVariants: {\n    variant: \"slideUp\",\n    duration: \"normal\",\n    stagger: \"medium\",\n  },\n});\n\n// Animation configuration mapped to variants (GSAP inital states)\nconst GSAPOriginalStatesMap = {\n  variant: {\n    fade: {\n      initial: { opacity: 0 },\n    },\n    slideUp: {\n      initial: { opacity: 0, y: \"25%\" },\n    },\n    slideDown: {\n      initial: { opacity: 0, y: \"-25%\" },\n    },\n    slideLeft: {\n      initial: { opacity: 0, x: \"25%\" },\n    },\n    slideRight: {\n      initial: { opacity: 0, x: \"-25%\" },\n    },\n    scale: {\n      initial: { opacity: 0, scale: 0 },\n    },\n    blur: {\n      initial: { opacity: 0, filter: \"blur(8px)\" },\n    },\n  },\n  duration: {\n    fast: 0.3,\n    normal: 0.9,\n    slow: 1.5,\n  },\n  stagger: {\n    none: 0,\n    small: 0.02,\n    medium: 0.05,\n    large: 0.1,\n  },\n} as const;\n\nexport interface TextRevealProps\n  extends\n    React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof textRevealVariants> {\n  as?: React.ElementType;\n  children: React.ReactNode;\n  delay?: number;\n  customDuration?: number;\n  splitBy?: \"char\" | \"word\" | \"line\";\n  triggerOnView?: boolean;\n  once?: boolean;\n}\n\nfunction TextRevealComponent(\n  {\n    className,\n    variant,\n    duration,\n    stagger,\n    as,\n    children,\n    delay = 0,\n    customDuration,\n    splitBy = \"char\",\n    triggerOnView = true,\n    once = true,\n    ...props\n  }: TextRevealProps,\n  ref: React.Ref<HTMLDivElement>,\n): React.ReactElement {\n  const isTextOnly = typeof children === \"string\";\n  const Comp = as ? as : isTextOnly ? \"p\" : Slot;\n  const containerRef = React.useRef<HTMLDivElement>(null);\n  const textContentRef = React.useRef<string>(\"\");\n  const [isProcessed, setIsProcessed] = React.useState(false);\n  const [prefersReducedMotion, setPrefersReducedMotion] = React.useState(false);\n  const [ariaLabel, setAriaLabel] = React.useState<string | undefined>(\n    undefined,\n  );\n\n  React.useImperativeHandle(ref, () => containerRef.current!);\n\n  // Detect prefers-reduced-motion\n  React.useEffect(() => {\n    const mediaQuery = window.matchMedia(\"(prefers-reduced-motion: reduce)\");\n    setPrefersReducedMotion(mediaQuery.matches);\n\n    const handleChange = (e: MediaQueryListEvent) => {\n      setPrefersReducedMotion(e.matches);\n    };\n\n    mediaQuery.addEventListener(\"change\", handleChange);\n    return () => mediaQuery.removeEventListener(\"change\", handleChange);\n  }, []);\n\n  // Get animation config from variants\n  const variantConfig = GSAPOriginalStatesMap.variant[variant || \"slideUp\"];\n  const animationDuration =\n    customDuration ?? GSAPOriginalStatesMap.duration[duration || \"normal\"];\n  const staggerDelay = GSAPOriginalStatesMap.stagger[stagger || \"medium\"];\n\n  // Split text and wrap in spans before paint \n  React.useLayoutEffect(() => {\n    if (!containerRef.current || isProcessed) return;\n\n    const text = containerRef.current.textContent || \"\";\n    if (!text || text === textContentRef.current) return;\n\n    // Set aria-label from the actual text content\n    setAriaLabel(text);\n\n    // If reduced motion is preferred, don't split the text - keep it accessible\n    if (prefersReducedMotion) {\n      setIsProcessed(true);\n      return;\n    }\n\n    textContentRef.current = text;\n    const fragment = document.createDocumentFragment();\n\n    if (splitBy === \"char\") {\n      const words = text.split(\" \");\n      words.forEach((word, wordIndex) => {\n        const wordSpan = document.createElement(\"span\");\n        wordSpan.style.display = \"inline-block\";\n        wordSpan.style.whiteSpace = \"nowrap\";\n\n        const chars = word.split(\"\");\n        chars.forEach((char) => {\n          const charSpan = document.createElement(\"span\");\n          charSpan.className = cn(\n            \"inline-block\",\n            \"opacity-0\",\n            \"text-reveal-element\",\n          );\n          charSpan.textContent = char;\n          charSpan.style.display = \"inline-block\";\n\n          gsap.set(charSpan, variantConfig.initial);\n          wordSpan.appendChild(charSpan);\n        });\n\n        fragment.appendChild(wordSpan);\n\n        if (wordIndex < words.length - 1) {\n          fragment.appendChild(document.createTextNode(\" \"));\n        }\n      });\n    } else {\n      let elements: string[] = [];\n\n      if (splitBy === \"word\") {\n        elements = text.split(\" \");\n      } else if (splitBy === \"line\") {\n        elements = text.split(\"\\n\");\n      }\n\n      elements.forEach((element, index) => {\n        const span = document.createElement(\"span\");\n        span.className = cn(\n          \"inline-block\",\n          \"opacity-0\",\n          \"text-reveal-element\",\n        );\n        span.textContent = element;\n        span.style.display = \"inline-block\";\n\n        gsap.set(span, variantConfig.initial);\n        fragment.appendChild(span);\n\n        if (splitBy === \"word\" && index < elements.length - 1) {\n          fragment.appendChild(document.createTextNode(\" \"));\n        }\n      });\n    }\n\n    // Append characters to container\n    containerRef.current?.replaceChildren(fragment);\n    setIsProcessed(true);\n  }, [children, splitBy, variant, prefersReducedMotion]);\n\n  useGSAP(\n    () => {\n      if (!containerRef.current || !isProcessed || prefersReducedMotion) return;\n\n      const elements = containerRef.current.querySelectorAll(\n        \".text-reveal-element\",\n      );\n      if (elements.length === 0) return;\n\n      // Animation properties\n      const animationProps: gsap.TweenVars = {\n        opacity: 1,\n        y: 0,\n        x: 0,\n        scale: 1,\n        filter: \"blur(0px)\",\n        duration: animationDuration,\n        ease: \"power2.out\",\n        stagger: staggerDelay,\n        delay: delay,\n      };\n\n      if (triggerOnView) {\n        gsap.fromTo(elements, variantConfig.initial, {\n          ...animationProps,\n          scrollTrigger: {\n            trigger: containerRef.current,\n            start: \"top 80%\",\n            toggleActions: once\n              ? \"play none none none\"\n              : \"play none none reverse\",\n          },\n        });\n      } else {\n        gsap.fromTo(elements, variantConfig.initial, animationProps);\n      }\n    },\n    {\n      scope: containerRef,\n      dependencies: [\n        isProcessed,\n        prefersReducedMotion,\n        variant,\n        animationDuration,\n        staggerDelay,\n        delay,\n        triggerOnView,\n        once,\n      ],\n    },\n  );\n\n  return (\n    <Comp\n      ref={containerRef}\n      className={cn(\n        !isProcessed && !prefersReducedMotion && \"opacity-0\",\n        className,\n      )}\n      aria-label={ariaLabel}\n      {...props}\n    >\n      {children}\n    </Comp>\n  );\n}\n\nconst TextReveal = React.forwardRef<HTMLDivElement, TextRevealProps>(TextRevealComponent);\n\nexport { TextReveal, textRevealVariants };\n",
      "type": "registry:ui"
    }
  ]
}